@page "/"
@using System.IdentityModel.Tokens.Jwt

@using Blazor_wasm.Models
@using Blazor_wasm.Models.APIModels
@using Blazor_wasm.Models.AuthModels
@using Blazor_wasm.Authentication

@using Newtonsoft.Json;
@using Microsoft.AspNetCore.Components.Authorization

@inject IAppService AppService
@inject NavigationManager NavManager;
@inject AuthenticationStateProvider authStateProvider

@code {

    protected async override Task OnInitializedAsync()
    {
        if (Setting.UserBasicDetail != null)
        {
            NavManager.NavigateTo("/dashboard");
        }
        else
        {
            var customAuthStateProvider = (CustomAuthenticationStateProvider)authStateProvider;
            await customAuthStateProvider.UpdateAuthenticationState(new UserBasicDetail());
            NavManager.NavigateTo("/login");
        }            
    }
}
